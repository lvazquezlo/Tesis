select(entidad, edad, fsexual, nhijos, gesta, naborto) %>%
filter(entidad == "CIUDAD DE MEXICO", !is.na(edad:naborto))
abortos_data %>%
select(entidad, edad, fsexual, nhijos, gesta, naborto) %>%
filter(entidad == "CIUDAD DE MEXICO")
abortos_data %>%
select(entidad, edad, fsexual, nhijos, gesta, naborto) %>%
filter(entidad == "CIUDAD DE MEXICO", !is.na(edad))
abortos_data %>%
select(entidad, edad, fsexual, nhijos, gesta, naborto) %>%
filter(entidad == "CIUDAD DE MEXICO", !is.na(edad),!is.na(fsexual),!is.na(nhijos),!is.na(gesta),!is.na(naborto))
abortos_data %>%
select(entidad, edad, fsexual, nhijos, gesta, naborto) %>%
filter(entidad == "CIUDAD DE MEXICO", !is.na(edad),!is.na(fsexual),!is.na(nhijos),!is.na(gesta),!is.na(naborto)) %>%
select(-entidad)
input_data <- abortos_data %>%
select(entidad, edad, fsexual, nhijos, gesta, naborto) %>%
filter(entidad == "CIUDAD DE MEXICO", !is.na(edad),!is.na(fsexual),!is.na(nhijos),!is.na(gesta),!is.na(naborto)) %>%
select(-entidad)
mod0 <- lm(naborto ~ ., data = input_data)
summary(mod0)
plot(mod0)
abortos_data
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto))
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto, na.rm = TRUE))
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto, na.rm = TRUE)) %>%
ggplot(aes(media, entidad)) %>%
geom_bar()
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto, na.rm = TRUE)) %>%
ggplot(aes(media, entidad)) +
geom_bar()
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto, na.rm = TRUE)) %>%
ggplot(aes(media_abortos, entidad)) +
geom_bar()
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto, na.rm = TRUE)) %>%
ggplot(aes(media_abortos, entidad)) +
geom_col()
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto, na.rm = TRUE)) %>%
mutate(media_abortos = fct_reorder(media_abortos, sum)) %>%
ggplot(aes(media_abortos, entidad)) +
geom_col()
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto, na.rm = TRUE)) %>%
ggplot(aes(media_abortos, entidad)) +
geom_col()
theme_set(theme_light())
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(media_abortos = mean(naborto, na.rm = TRUE)) %>%
ggplot(aes(media_abortos, entidad)) +
geom_col()
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
count(naborto)
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
summarise(n_abortos = n(naborto))
abortos_data %>%
filter(!is.na(entidad)) %>%
group_by(entidad) %>%
count()
abortos_data %>%
filter(entidad == "CIUDAD DE MEXICO") %>%
group_by(alc_o_municipio) %>%
count()
abortos_data %>%
filter(entidad == "CIUDAD DE MEXICO") %>%
group_by(alc_o_municipio) %>%
count() %>%
ggplot(aes(n, alc_o_municipio)) +
geom_col()
abortos_data %>%
filter(entidad == "CIUDAD DE MEXICO") %>%
group_by(alc_o_municipio) %>%
count() %>%
filter(n > 10) %>%
ggplot(aes(n, alc_o_municipio)) +
geom_col()
abortos_data %>%
filter(entidad == "CIUDAD DE MEXICO") %>%
group_by(alc_o_municipio) %>%
count() %>%
filter(n > 10) %>%
mutate(alc_o_municipio = fct_reorder(alc_o_municipio, n)) %>%
ggplot(aes(n, alc_o_municipio)) +
geom_col()
abortos_data %>%
filter(entidad == "CIUDAD DE MEXICO") %>%
group_by(alc_o_municipio) %>%
count() %>%
filter(n > 10) %>%
mutate(alc_o_municipio = fct_reorder(alc_o_municipio, -n)) %>%
ggplot(aes(n, alc_o_municipio)) +
geom_col()
library(tidyverse)
library(readxl)
library(janitor)
library(skimr)
library(lubridate)
library(stringr)
library(scales)
library(ggtext)
theme_set(theme_light())
ruta <- "C:/Users/luivazquez/Downloads/R/int/"
diccionario_data <- read_csv(paste0(ruta, "Diccionario de datos ILE.csv")) %>%
clean_names()
abortos_data <- read_csv(paste0(ruta, "Int_Leg_Emb.csv")) %>%
clean_names() %>%
mutate(across(where(is.character), str_to_title),
clues_hospital = str_to_upper(clues_hospital),
year = year(fingreso),
month = month(fingreso),
clues_hospital = as_factor(clues_hospital))
ruta <- "Documents/itam/Curso_R/"
diccionario_data <- read_csv(paste0(ruta, "Diccionario de datos ILE.csv")) %>%
clean_names()
abortos_data <- read_csv(paste0(ruta, "Int_Leg_Emb.csv")) %>%
clean_names() %>%
mutate(across(where(is.character), str_to_title),
clues_hospital = str_to_upper(clues_hospital),
year = year(fingreso),
month = month(fingreso),
clues_hospital = as_factor(clues_hospital))
abortos_cdmx <- abortos_data %>%
filter(entidad == "Ciudad De Mexico", !is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio))
skim(abortos_cdmx)
abortos_cdmx %>%
group_by(date_aux) %>%
count() %>%
ungroup() %>%
ggplot(aes(date_aux, n)) +
geom_line(color = "darkolivegreen4") +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile")
abortos_data
abortos_data %>%
mutate(capital = if_else(entidad == "Ciudad De Mexico", "Capital", "Provincia"))
abortos_data <- read_csv(paste0(ruta, "Int_Leg_Emb.csv")) %>%
clean_names() %>%
mutate(across(where(is.character), str_to_title),
clues_hospital = str_to_upper(clues_hospital),
year = year(fingreso),
month = month(fingreso),
clues_hospital = as_factor(clues_hospital),
capital = if_else(entidad == "Ciudad De Mexico", "Capital", "Provincia"))
abortos_data %>% View()
abortos_data %>%
filter(!is.na(fingreso, year >= 2016)) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio))
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio))
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux) %>%
count() %>%
ungroup() %>%
ggplot(aes(date_aux, n, color = capital)) +
geom_line(color = "darkolivegreen4") +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile")
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux) %>%
count()
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup()
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup() %>%
ggplot(aes(date_aux, n, color = capital)) +
geom_line(color = "darkolivegreen4") +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile")
?aes
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup() %>%
ggplot(aes(date_aux, n, colour = capital)) +
geom_line(color = "darkolivegreen4") +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile")
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup() %>%
ggplot(aes(date_aux, n, color = capital)) +
geom_line(color = "darkolivegreen4") +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile")
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup()
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup() %>%
ggplot(aes(date_aux, n, color = capital)) +
geom_line() +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile")
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup() %>%
filter(!is.na(capital)) %>%
ggplot(aes(date_aux, n, color = capital)) +
geom_line() +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile")
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup() %>%
filter(!is.na(capital)) %>%
ggplot(aes(date_aux, n, color = capital)) +
geom_line() +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile") +
theme(legend.position = "bottom")
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup() %>%
filter(!is.na(capital)) %>%
ggplot(aes(date_aux, n, color = capital)) +
geom_line() +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en la CDMX a través del tiempo?",
subtitle = "Número de abortos mensuales",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile",
color = "") +
theme(legend.position = "bottom")
abortos_data %>%
filter(!is.na(fingreso), year >= 2016) %>%
mutate(date_aux = dmy(paste0("01-", month, "-", year)),
alc_o_municipio = if_else(alc_o_municipio == "La Magdalena Contreras", "Magdalena Contreras", alc_o_municipio)) %>%
group_by(date_aux, capital) %>%
count() %>%
ungroup() %>%
filter(!is.na(capital)) %>%
ggplot(aes(date_aux, n, color = capital)) +
geom_line() +
geom_vline(xintercept = dmy("01-12-2018"), linetype = "dotted") +
scale_y_continuous(labels = scales::label_comma()) +
labs(x = "",
y = "# de abortos",
title = "¿Cómo ha cambiado el número de abortos en México a través del tiempo?",
subtitle = "Número de abortos mensuales, CDMX vs resto de la República",
caption = "Fuente: https://www.semujeres.cdmx.gob.mx/ile",
color = "") +
theme(legend.position = "bottom")
library(tidyverse)
library(readxl)
library(janitor)
library(skimr)
library(lubridate)
library(stringr)
library(scales)
library(ggtext)
theme_set(theme_light())
ruta <- "Documents/itam/Curso_R/"
diccionario_data <- read_csv(paste0(ruta, "Diccionario de datos ILE.csv")) %>%
clean_names()
abortos_data <- read_csv(paste0(ruta, "Int_Leg_Emb.csv")) %>%
clean_names() %>%
mutate(across(where(is.character), str_to_title),
clues_hospital = str_to_upper(clues_hospital),
year = year(fingreso),
month = month(fingreso),
clues_hospital = as_factor(clues_hospital),
capital = if_else(entidad == "Ciudad De Mexico", "Capital", "Provincia"))
knitr::opts_chunk$set(echo = TRUE)
muetra1 <- rnorm(10000, mean = 13000, sd = 800)
muestra2 <- rnorm(10000, mean = 8000, sd = 600)
t.test(muestra1, muestra2)
muestra1 <- rnorm(10000, mean = 13000, sd = 800)
muestra2 <- rnorm(10000, mean = 8000, sd = 600)
t.test(muestra1, muestra2)
hombres <- rnorm(10000, mean = 13000, sd = 800)
mujeres <- rnorm(10000, mean = 8000, sd = 600)
t.test(muestra1, muestra2)
hombres <- rnorm(10000, mean = 13000, sd = 800)
mujeres <- rnorm(10000, mean = 8000, sd = 600)
t.test(hombres, mujeres)
?t.test
hombres <- rnorm(100, mean = 13000, sd = 800)
mujeres <- rnorm(100, mean = 8000, sd = 600)
t.test(hombres, mujeres)
t.test(hombres, mujeres, alternative = c("two.sided"))
hombres <- rnorm(100, mean = 8000, sd = 800)
mujeres <- rnorm(100, mean = 8000, sd = 600)
t.test(hombres, mujeres, alternative = c("two.sided"))
t.test(hombres, mujeres, alternative = c("greater"))
hombres <- rnorm(100, mean = 8500, sd = 800)
mujeres <- rnorm(100, mean = 8000, sd = 800)
t.test(hombres, mujeres, alternative = c("greater"), var.equal = TRUE)
?stats
library(help = "stats")
library(tidyverse)
library(skimr)
library(normtest)
library(nortest)
library(MASS)
library(car)
library(moments)
library(gglm)
library(ggfortify)
theme_set(theme_light())
ruta <- "~/Documents/itam/Tesis_git/"
setwd(ruta)
data_modelo <- readRDS(file = "Output/data_modelo.rds")
df.aventurate <- data_modelo[[1]]
df.educativo <- data_modelo[[2]] %>%
na.omit()
df.sueno <- data_modelo[[3]]
df.tradicional <- data_modelo[[4]]
df.global <- data_modelo[[5]]
mod_log_log <- function(df){
df %>%
mutate(campus = if_else(campus == "Si", 1, 0),
campus = as.factor(campus)) %>%
lm(log(Venta_Estado) ~ log(pib_pc), data = .)
}
#Aventurate
aven1 <- mod_log_log(df.aventurate)
autoplot(aven1)
autoplot(aven1)
#Aventurate
aven1 <- mod_log_log(df.aventurate)
autoplot(aven1)
jb.norm.test(aven1$residuals)
#Educativo
educ1 <- mod_log_log(df.educativo)
autoplot(educ1)
#Educativo
educ1 <- mod_log_log(df.educativo)
autoplot(educ1)
jb.norm.test(educ1$residuals)
#Mi sueño
suen1 <- mod_log_log(df.sueno)
autoplot(suen1)
jb.norm.test(suen1$residuals)
ad.test(suen1$residuals)
jb.norm.test(suen1$residuals)
jb.norm.test(suen1$residuals)
jb.norm.test(suen1$residuals)
jb.norm.test(suen1$residuals)
jb.norm.test(suen1$residuals)
x <- rnorm(217, mean = 430, sd = 150)
jb.norm.test(x)
x <- rnorm(217, mean = 430, sd = 150)
jb.norm.test(x)
x <- rnorm(217, mean = 430, sd = 150)
jb.norm.test(x)
bxcx <- function(modelo, df){
b <- boxcox(modelo)
lambda <- b$x # lambda values
lik <- b$y # log likelihood values for SSE
bc <- cbind(lambda, lik) # combine lambda and lik
sorted_bc <- bc[order(-lik),] # values are sorted to identify the lambda    value for the maximum log likelihood for obtaining minimum SSE
lambda_selection <- round(sorted_bc[1,1],2) # lambda value selected for making the transformation
mod_t <- lm(Venta_Estado^(lambda_selection) ~ pib_pc + I(pib_pc^2), data = df)
return(mod_t)
}
aven_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.aventurate)
aventurate_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.aventurate)
aventurate_sq <- bxcx(aventurate_sq, df.aventurate)
autoplot(aventurate_sq)
educativo_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.educativo)
educativo_sq <- bxcx(educativo_sq, df.educativo)
autoplot(educativo_sq)
jb.norm.test(educativo_sq$residuals)
jb.norm.test(educativo_sq$residuals)
educativo_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.educativo)
plot(educativo_sq)
boxcox(educativo_sq)
boxcox(educativo_sq)$x
educativo_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.educativo)
transformacion <- boxcox(educativo_sq)
l <- transformacion$x
li <- transformacion$y
l_li <- cbind(l, li)
l_li_ordenado <- l_li[order(-li),]
round(l_li_ordenado, 2)
educativo_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.educativo)
plot(educativo_sq)
educativo_sq <- bxcx(educativo_sq, df.educativo)
autoplot(educativo_sq)
educativo_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.educativo)
educativo_sq <- bxcx(educativo_sq, df.educativo)
autoplot(educativo_sq)
autoplot(aventurate_sq)
sueno_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.sueno)
sueno_sq <- bxcx(sueno_sq, df.sueno)
autoplot(sueno_sq)
#Sorteo Tradicional
tradicional_sq <- lm(Venta_Estado ~ pib_pc + I(pib_pc ^ 2), data = df.tradicional)
tradicional_sq <- bxcx(tradicional_sq, df.tradicional)
autoplot(tradicional_sq)
autoplot(educativo_sq)
autoplot(sueno_sq)
plot(sueno_sq)
