rename(n_boletos = Venta_Estado) %>%
cor() %>%
ggcorrplot(ggtheme = theme_light(),
lab = TRUE,
colors = c("#E46726", "white", "#6D9EC1")) +
labs(subtitle = paste0("Sorteo: ", str_remove_all(df[1,2], "[0-9]")))
corplot <- function(df){
df %>%
filter(!is.na(pib_pc)) %>%
select(Venta_Estado, pib_pc, campus) %>%
mutate(campus = if_else(campus == "Si", 1, 0),
Venta_Estado = log(Venta_Estado),
pib_pc = log(pib_pc)) %>%
rename(n_boletos = Venta_Estado) %>%
cor() %>%
ggcorrplot(ggtheme = theme_light(),
lab = TRUE,
colors = c("#E46726", "white", "#6D9EC1")) +
labs(subtitle = paste0("Sorteo: ", str_remove_all(df[1,2], "[0-9]")))
}
cp1 <- df.aventurate %>%
corplot() +
theme(legend.position = "none")
cp2 <- df.educativo %>%
corplot()
(cp1|cp2)
df.sueno %>%
corplot() %>%
theme(legend.position = "none")
df.sueno %>%
corplot() %>%
theme(legend.position = "none")
corplot <- function(df){
df %>%
filter(!is.na(pib_pc)) %>%
select(Venta_Estado, pib_pc, campus) %>%
mutate(campus = if_else(campus == "Si", 1, 0),
Venta_Estado = log(Venta_Estado),
pib_pc = log(pib_pc)) %>%
rename(n_boletos = Venta_Estado) %>%
cor() %>%
ggcorrplot(ggtheme = theme_light(),
lab = TRUE,
colors = c("#E46726", "white", "#6D9EC1")) +
labs(subtitle = paste0("Sorteo: ", str_remove_all(df[1,2], "[0-9]")))
}
cp1 <- df.aventurate %>%
corplot() +
theme(legend.position = "none")
df.sueno %>%
corplot() %>%
theme(legend.position = "none")
df.sueno
df.sueno %>%
corplot() +
theme(legend.position = "none")
df.tradicional %>%
corplot()
df.sueno %>%
corplot() +
theme(legend.position = "none")
cp3 <- df.sueno %>%
corplot() +
theme(legend.position = "none")
cp4 <- df.tradicional %>%
corplot()
(cp3|cp4)
df.global %>%
mutate(Sorteo = str_remove(Sorteo, "\\d+"),
Sorteo = str_to_title(Sorteo)) %>%
group_by(Sorteo) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
mutate(Sorteo = fct_reorder(Sorteo, n_boletos)) %>%
ggplot(aes(n_boletos, Sorteo)) +
geom_point(col = "tomato2", size = 3) +
geom_segment(aes(x = min(n_boletos),
xend = max(n_boletos),
y = Sorteo,
yend = Sorteo),
linetype = "dashed",
size = 0.1) +
scale_x_continuous(labels = comma) +
theme_classic() +
labs(title = "Total de boletos vendidos por sorteo ",
subtitle = "entre 2015 y 2019",
x = "Número de boletos",
y = "")
df.global %>%
mutate(Sorteo = str_remove(Sorteo, "\\d+")) %>%
group_by(Sorteo, Fecha) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos)) +
geom_line() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Sorteo, scales = "free_y") +
labs(x = "",
y = "Boletos Vendidos",
title = "Serie de boletos vendidos",
subtitle = "entre 2015 y 2019")
df.aventurate %>%
#  filter(Estado != "Nuevo Leon") %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(title = "Número de boletos vendidos entre 2015 y 2019",
subtitle = "Sorteo: Aventúrate",
x = "Boletos Vendidos",
y = "",
fill = "Color")
df.aventurate %>%
#  filter(Estado != "Nuevo Leon") %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(title = "Número de boletos vendidos entre 2015 y 2019 por Estado",
subtitle = "Sorteo: Aventúrate",
x = "Boletos Vendidos",
y = "",
fill = "Color")
df.educativo %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(title = "Número de boletos vendidos (2015 - 2019)",
subtitle = "Sorteo: Educativo",
x = "Boletos Vendidos",
y = "",
fill = "Campus")
df.aventurate %>%
#  filter(Estado != "Nuevo Leon") %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(title = "Número de boletos vendidos entre 2015 y 2019 por Estado",
subtitle = "Sorteo: Aventúrate",
x = "Boletos Vendidos",
y = "",
fill = "Color")
df.aventurate %>%
#  filter(Estado != "Nuevo Leon") %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(title = "Número de boletos vendidos entre 2015 y 2019 por Estado",
subtitle = "Sorteo: Aventúrate",
x = "Boletos Vendidos",
y = "",
fill = "Campus")
df.educativo %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(title = "Número de boletos vendidos (2015 - 2019)",
subtitle = "Sorteo: Educativo",
x = "Boletos Vendidos",
y = "",
fill = "Campus")
df.sueno %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(title = "Número de boletos vendidos (2015 - 2019)",
subtitle = "Sorteo: Mi Sueño",
x = "Boletos Vendidos",
y = "",
fill = "Campus")
df.tradicional %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(title = "Número de boletos vendidos (2015 - 2019)",
subtitle = "Sorteo: Tradicional",
x = "Boletos Vendidos",
y = "",
fill = "Campus")
df.educativo %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(subtitle = "Sorteo: Educativo",
x = "Boletos Vendidos",
y = "",
fill = "Campus")
df.sueno %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(subtitle = "Sorteo: Mi Sueño",
x = "Boletos Vendidos",
y = "",
fill = "Campus")
df.tradicional %>%
group_by(Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(n_boletos, Estado, fill = campus)) +
geom_col() +
scale_x_continuous(labels = comma) +
labs(subtitle = "Sorteo: Tradicional",
x = "Boletos Vendidos",
y = "",
fill = "Campus")
mayores_boletos <- function(df){
df %>%
group_by(Estado) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
slice_max(order_by = n_boletos, n = 15) %>%
pull(Estado) %>%
as.character()
}
df.aventurate %>%
filter(Estado %in% mayores_boletos(df.aventurate)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(title = "Los 15 Estados que mayores ventas tuvieron entre 2015 - 2019",
subtitle = "Sorteo: Aventúrate",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.aventurate %>%
filter(Estado %in% mayores_boletos(df.aventurate)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(title = "Los 15 Estados que mayores ventas tuvieron entre 2015 - 2019",
subtitle = "Sorteo: Aventúrate",
x = "",
y = "Boletos Vendidos",
color = "Campus")
mayores_boletos <- function(df){
df %>%
group_by(Estado) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
slice_max(order_by = n_boletos, n = 14) %>%
pull(Estado) %>%
as.character()
}
df.aventurate %>%
filter(Estado %in% mayores_boletos(df.aventurate)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(title = "Los 15 Estados que mayores ventas tuvieron entre 2015 - 2019",
subtitle = "Sorteo: Aventúrate",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df %>%
group_by(Estado) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
slice_max(order_by = n_boletos, n = 13) %>%
pull(Estado) %>%
as.character()
mayores_boletos <- function(df){
df %>%
group_by(Estado) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
slice_max(order_by = n_boletos, n = 13) %>%
pull(Estado) %>%
as.character()
}
df.aventurate %>%
filter(Estado %in% mayores_boletos(df.aventurate)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(title = "Los 15 Estados que mayores ventas tuvieron entre 2015 - 2019",
subtitle = "Sorteo: Aventúrate",
x = "",
y = "Boletos Vendidos",
color = "Campus")
mayores_boletos <- function(df){
df %>%
group_by(Estado) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ungroup() %>%
slice_max(order_by = n_boletos, n = 15) %>%
pull(Estado) %>%
as.character()
}
df.aventurate %>%
filter(Estado %in% mayores_boletos(df.aventurate)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(title = "Los 15 Estados que mayores ventas tuvieron entre 2015 - 2019",
subtitle = "Sorteo: Aventúrate",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.educativo %>%
filter(Estado %in% mayores_boletos(df.educativo)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(subtitle = "Sorteo: Educativo",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.educativo %>%
filter(Estado %in% mayores_boletos(df.educativo)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(subtitle = "Sorteo: Educativo",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.sueno %>%
filter(Estado %in% mayores_boletos(df.sueno)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(subtitle = "Sorteo: Mi Sueño",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.sueno %>%
filter(Estado %in% mayores_boletos(df.sueno)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(subtitle = "Sorteo: Mi Sueño",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.sueno %>%
filter(Estado %in% mayores_boletos(df.sueno)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado))
df.sueno %>%
filter(Estado %in% mayores_boletos(df.sueno)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
mutate(Estado = fct_reorder(Estado, n_boletos)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(subtitle = "Sorteo: Mi Sueño",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.sueno %>%
filter(Estado %in% mayores_boletos(df.sueno)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(subtitle = "Sorteo: Mi Sueño",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.tradicional %>%
filter(Estado %in% mayores_boletos(df.tradicional)) %>%
group_by(Fecha, Estado, campus) %>%
summarise(n_boletos = sum(Venta_Estado)) %>%
ggplot(aes(Fecha, n_boletos, color = campus)) +
geom_line() +
geom_point() +
scale_y_continuous(labels = comma) +
facet_wrap(~ Estado, scales = "free_y") +
labs(subtitle = "Sorteo: Tradicional",
x = "",
y = "Boletos Vendidos",
color = "Campus")
df.aventurate %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm")
df.aventurate %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
df.aventurate %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Boletos vendidos vs PIB pc (log -log) entre 2015 y 2019",
subtitle = "Sorteo Aventurate",
x = "ln(PIB pc)",
y = "ln(# Boletos)")
df.aventurate %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Boletos vendidos vs PIB pc (log -log) entre 2015 y 2019",
subtitle = "Sorteo: Aventurate",
x = "ln(PIB pc)",
y = "ln(# Boletos)")
df.educativo %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(subtitle = "Sorteo: Educativo",
x = "ln(PIB pc)",
y = "ln(# Boletos)")
sp1 <- df.aventurate %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Boletos vendidos vs PIB pc (log -log) entre 2015 y 2019",
subtitle = "Sorteo: Aventurate",
x = "ln(PIB pc)",
y = "ln(# Boletos)")
sp2 <- df.educativo %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(subtitle = "Sorteo: Educativo",
x = "ln(PIB pc)",
y = "ln(# Boletos)")
(sp1/sp2)
sp1 <- df.aventurate %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Boletos vendidos vs PIB pc (log - log) entre 2015 y 2019",
subtitle = "Sorteo: Aventurate",
x = "ln(PIB pc)",
y = "ln(# Boletos)")
sp2 <- df.educativo %>%
ggplot(aes(log(pib_pc), log(Venta_Estado))) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(subtitle = "Sorteo: Educativo",
x = "ln(PIB pc)",
y = "ln(# Boletos)")
(sp1/sp2)
